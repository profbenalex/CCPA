<!DOCTYPE html>
<html>
<head>
  <title>CCPA Members Register</title>
  <meta name="google-signin-client_id" content="290713393187-sfvukqfmffktomufhtuknnvcjk55e3a8.apps.googleusercontent.com">
</head>
<body>
  <h2>CCPA Members Register</h2>

  <button onclick="handleAuthClick()">🔐 Authorize</button>
  <button onclick="listData()">📖 Read Sheet</button>
  <button onclick="appendRow()">📝 Add Row</button>

  <pre id="output">Waiting for user action...</pre>

  <script>
    const CLIENT_ID = '290713393187-sfvukqfmffktomufhtuknnvcjk55e3a8.apps.googleusercontent.com';
    const SPREADSHEET_ID = '1FUzgEatxn_pr2LkqDdRq0m0kPC6zsX0T0J3-MBifqD4';
    const SHEET_NAME = 'register';
    const SCOPES = 'https://www.googleapis.com/auth/spreadsheets';

    function log(message) {
      document.getElementById('output').textContent += `\n${message}`;
      console.log(message);
    }

    function gapiLoaded() {
      console.log('🔃 GAPI loaded, initializing...');
      gapi.load('client:auth2', initializeGapiClient);
    }

    async function initializeGapiClient() {
      try {
        await gapi.client.init({
          clientId: CLIENT_ID,
          scope: SCOPES,
        });
        log('✅ GAPI initialized');
      } catch (err) {
        log('❌ GAPI init failed: ' + err.message);
      }
    }

    function handleAuthClick() {
      const auth = gapi.auth2.getAuthInstance();
      if (!auth) {
        log('⚠️ Auth instance not ready. GAPI not initialized yet.');
        return;
      }
      auth.signIn().then(() => {
        const email = auth.currentUser.get().getBasicProfile().getEmail();
        log(`✅ Signed in as: ${email}`);
      }).catch((err) => {
        log(`❌ Sign-in failed: ${err.error}`);
      });
    }

    async function listData() {
      try {
        const response = await gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: SPREADSHEET_ID,
          range: `${SHEET_NAME}!A1:N`,
        });
        const
