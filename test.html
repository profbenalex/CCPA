<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>bcquality Sheet Test</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <h2>🔍 bcquality Sheet Viewer</h2>
  <button id="authButton">🔐 Sign in with Google</button>
  <pre id="output"></pre>

  <script>
    const clientId = '566030013012-fp4pfljo6t586lo83dq7cdf7umcs07td.apps.googleusercontent.com';
    const sheetId = '1kSctyDuy35alQsG_vN7FswSs2wKGNmk2T-N1MJWYQvI';
    let tokenClient;
    let accessToken = '';

    document.getElementById("authButton").addEventListener("click", () => {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: clientId,
        scope: 'https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive',
        callback: (tokenResponse) => {
          accessToken = tokenResponse.access_token;
          fetchSheetData();
        },
      });
      tokenClient.requestAccessToken();
    });

    function fetchSheetData() {
      fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/documents`, {
        headers: {
          Authorization: `Bearer ${accessToken}`
        }
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("output").textContent = JSON.stringify(data, null, 2);
      })
      .catch(err => {
        document.getElementById("output").textContent = '❌ Error: ' + err;
      });
    }
  </script>
</body>
</html>
